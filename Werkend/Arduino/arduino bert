oid AutomationShield::loop() {
    if (Serial.available() > 0){

        static int flag;
        static int actuator;
        static int sensor;
        static int pot;

        receive(flag, actuator);

        switch(flag) {
            case TEST: {
                outBuffer[0] = version;
                outBuffer[1] = shield_id[0];
                outBuffer[2] = shield_id[1];
                break;
            }
            case RUN: {
                actuatorWrite(actuator);
                sensor = sensorRead();
                pot = referenceRead();
                setOutBuffer(pot, sensor);
                break;
            }
            case STOP: {
                actuatorWrite(0);
                break;
            }
        }
        send();
    }
}
